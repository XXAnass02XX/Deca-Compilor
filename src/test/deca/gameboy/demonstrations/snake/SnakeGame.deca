#include "GameBoy.decah"
#include "Snake.deca"
#includeTiles "snake_tiles"

{
    Snake snake = new Snake();
    boolean gameEnded = false;
    int frameCount = 0;
    int i=0;
    GameBoy gb = new GameBoy();
    int limiteFrameCount = 30;
    boolean initScreen = true;


    gb.init();
    gb.setBackgroundColor(5);
    gb.updateScreen();
    print("            ", 4, 2);
    print(" snake game ", 4, 3);
    print("            ", 4, 4);
    print(" a for easy mode ", 1, 9);
    gb.setColor(gb.WHITE, 18, 9);
    gb.setColor(gb.WHITE, 18, 11);
    print(" b for hard mode ", 1, 11);
    while (initScreen) {
     gb.updateScreen();
     if(gb.keyPressed(gb.A_KEY)) {
        limiteFrameCount = 90;
        initScreen = false;
     }
     if(gb.keyPressed(gb.B_KEY)) {
         initScreen = false;
      }
    }

    gb.setBackgroundColor(gb.WHITE);
    gb.updateScreen();


    snake.initSnake(gb,6,6,20,18,15,15);
    while(!gameEnded){
        gb.updateScreen();
         //input
         if(gb.keyPressed(gb.UP_KEY) && snake.getDirection() == snake.HorizontalDirection){
            i = 0;
         }
         if(gb.keyPressed(gb.DOWN_KEY) && snake.getDirection() == snake.HorizontalDirection){
            i = 1;
         }
         if(gb.keyPressed(gb.RIGHT_KEY) && snake.getDirection() == snake.VerticalDirection){
            i = 2;
         }
         if(gb.keyPressed(gb.LEFT_KEY) && snake.getDirection() == snake.VerticalDirection){
            i = 3;
         }

         frameCount = frameCount+1;
         if(frameCount == limiteFrameCount){
            frameCount = 0;
             gameEnded = !snake.move(i);    //on donne en argument le input, ca renvoie si on a perdu
         }
    }
}